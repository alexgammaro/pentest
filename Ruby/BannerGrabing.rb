#!/usr/bin/ruby
# coding: utf-8

require 'socket'

target_ports = 1..65535
tartget_ips = ['10.0.0.1','10.0.0.2','10.0.0.3']

def grab_banner(ip, port)
  TCPSocket.new(ip, port).recv(1024)
rescue
  "Unable to establish a connection with #{ip}:#{port}"
end

target_ips.each do |ip|
  target_ports.each do |port|
    puts grab_banner(ip, port)
  end
end
