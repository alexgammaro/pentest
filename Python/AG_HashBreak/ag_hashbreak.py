#!/usr/bin/python

import sys,crypt

if len(sys.argv) != 2:
    print("AG Solucoes")
    print("Modo de uso: python ag_hashbreak.py <wordlist>")
    print("Exemplo: python ag_hashbreak.py wl.txt")
    sys.exit(0)

var_hash=raw_input("Digite o Hash completo: ")
#print(var_hash)
salt=raw_input("Digite o salt: ")
#print(salt)

file = open(sys.argv[1], "r")

print("Testando...")

for senha in file.readlines():
    senha=senha.strip("\n")
    #print("Testando..." + senha)
    senhasalt=crypt.crypt(senha,salt)
    #print senhasalt
    if senhasalt == var_hash:
        print("Senha encontrada: " + senha)
    #else:
        #print("Testando senha" + senha)
