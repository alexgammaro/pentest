#!/usr/bin/python3

import sys
from scapy.all import *

conf.verb = 0

portas = [21,22,23,25,80,443,110,8083,8291]

pIP = IP(dst=sys.argv[1])
pTCP = TCP(dport=portas,flags="S")
pacote = pIP/pTCP
resp, noresp = sr(pacote)
#resp.show()
#print (resp[0][1].show())
#print (resp[0][1][TCP].sport)
#print (resp[0][1][TCP].flags)
for resposta in resp:
    porta = resposta[1][TCP].sport
    flag = resposta[1][TCP].flags
    #print (porta,flag)
    if (flag == "SA"):
        print ("Porta", porta , "aberta")
